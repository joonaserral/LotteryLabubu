<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>奖池管理 - Labubu 幸运抽奖</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --labu: #6b5b95;
            --labu2: #ffcc00;
        }

        body {
            font-family: 'Zen Maru Gothic', system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans SC', 'PingFang SC', 'Microsoft Yahei', sans-serif;
        }

        .labu-gradient {
            background-image: linear-gradient(135deg, rgba(107, 91, 149, .12), rgba(255, 204, 0, .12));
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900">
    <!-- 登录界面 -->
    <div id="loginOverlay" class="fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl shadow-2xl p-8 mx-4 w-full max-w-md">
            <div class="text-center mb-6">
                <div
                    class="w-16 h-16 rounded-2xl bg-[var(--labu)] grid place-content-center text-white text-2xl mx-auto mb-4">
                    🔒</div>
                <h2 class="text-2xl font-bold text-slate-900">管理员验证</h2>
                <p class="text-slate-600 mt-2">请输入管理员密码以访问系统</p>
            </div>
            <div class="space-y-4">
                <div>
                    <label for="adminPassword" class="block text-sm font-medium text-slate-700 mb-2">管理员密码</label>
                    <input type="password" id="adminPassword"
                        class="w-full px-4 py-3 rounded-xl border border-slate-300 focus:border-[var(--labu)] focus:ring-2 focus:ring-[var(--labu)]/20 focus:outline-none transition-colors"
                        placeholder="请输入密码">
                </div>
                <button id="loginBtn"
                    class="w-full px-4 py-3 rounded-xl bg-[var(--labu)] text-white font-medium hover:opacity-90 transition-opacity">
                    进入管理系统
                </button>
                <div class="text-center">
                    <a href="index.html" class="text-sm text-slate-500 hover:text-slate-700">返回抽奖页面</a>
                </div>
            </div>
            <div id="loginError" class="mt-4 text-sm text-red-600 text-center hidden"></div>
        </div>
    </div>

    <!-- 主界面内容 -->
    <div id="mainContent" class="hidden">
        <!-- 顶部栏 -->
        <header class="sticky top-0 z-10 backdrop-blur bg-white/60 border-b border-slate-200">
            <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-9 h-9 rounded-xl bg-[var(--labu)] grid place-content-center text-white text-xl">🦊
                    </div>
                    <h1 class="font-bold text-lg">奖池管理系统</h1>
                </div>
                <nav class="text-sm flex items-center gap-3">
                    <a href="index.html" class="hover:underline">返回抽奖</a>
                    <button id="logoutBtn" class="text-red-600 hover:underline">登出</button>
                </nav>
            </div>
        </header>

        <!-- Hero -->
        <section class="labu-gradient">
            <div class="max-w-5xl mx-auto px-4 py-10">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-extrabold leading-tight">奖池配置管理</h2>
                    <p class="mt-3 text-slate-700">管理员专用界面，用于配置和管理抽奖奖池设置</p>
                </div>
            </div>
        </section>

        <!-- 主要内容 -->
        <main class="max-w-5xl mx-auto px-4 py-10">
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- 奖池设置 -->
                <section>
                    <div class="rounded-3xl bg-white border border-slate-200 shadow overflow-hidden">
                        <div class="p-5 border-b border-slate-100 flex items-center justify-between">
                            <h3 class="font-semibold">奖池配置编辑</h3>
                            <div class="text-xs text-slate-500">配置将保存到本地浏览器</div>
                        </div>
                        <div class="p-5 grid gap-4">
                            <div class="text-sm text-slate-600">
                                <div class="mb-2">每行一个奖品，字段使用逗号分隔：<code>name,type,weight,quantity</code></div>
                                <ul class="text-xs space-y-1 text-slate-500">
                                    <li>• <b>name</b>: 奖品名称</li>
                                    <li>• <b>type</b>: 奖品类型，仅支持：<b>抵扣券</b>｜<b>实体</b>｜<b>折扣券</b></li>
                                    <li>• <b>weight</b>: 权重数值，数值越大越容易抽中</li>
                                    <li>• <b>quantity</b>: 库存数量，留空或 -1 表示不限量</li>
                                </ul>
                            </div>
                            <textarea id="poolEditor" rows="12"
                                class="w-full rounded-xl border border-slate-300 p-3 font-mono text-xs"></textarea>
                            <div class="flex gap-3 flex-wrap">
                                <button id="savePoolBtn"
                                    class="px-4 py-2 rounded-xl bg-[var(--labu)] text-white font-medium hover:opacity-90">保存奖池</button>
                                <button id="reloadBtn"
                                    class="px-4 py-2 rounded-xl bg-slate-100 border border-slate-200 hover:bg-slate-200">重新载入</button>
                                <button id="restoreDefaultBtn"
                                    class="px-4 py-2 rounded-xl bg-orange-100 text-orange-700 border border-orange-200 hover:bg-orange-200">恢复默认</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 当前奖池预览 -->
                <section>
                    <div class="rounded-3xl bg-white border border-slate-200 shadow overflow-hidden">
                        <div class="p-5 border-b border-slate-100 flex items-center justify-between">
                            <h3 class="font-semibold">当前奖池预览</h3>
                            <button id="refreshPreviewBtn"
                                class="text-xs px-2 py-1 rounded-lg bg-slate-100 border border-slate-200">刷新预览</button>
                        </div>
                        <div class="p-5">
                            <ul id="poolList" class="text-sm grid gap-2"></ul>
                            <div id="poolStats" class="mt-4 p-3 rounded-lg bg-slate-50 text-xs text-slate-600"></div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- 抽奖控制 -->
            <section class="mt-10">
                <div class="rounded-3xl bg-white border border-slate-200 shadow overflow-hidden">
                    <div class="p-5 border-b border-slate-100">
                        <h3 class="font-semibold">抽奖控制设置</h3>
                    </div>
                    <div class="p-5 grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium mb-3">抽奖次数限制</h4>
                            <div class="space-y-3">
                                <div>
                                    <label for="drawLimitInput"
                                        class="block text-sm font-medium text-slate-700 mb-1">每用户最大抽奖次数</label>
                                    <input type="number" id="drawLimitInput" min="1" max="9999"
                                        class="w-full px-3 py-2 rounded-lg border border-slate-300 focus:border-[var(--labu)] focus:ring-2 focus:ring-[var(--labu)]/20 focus:outline-none"
                                        placeholder="输入次数限制（0表示不限制）">
                                </div>
                                <div class="flex gap-3">
                                    <button id="saveDrawLimitBtn"
                                        class="px-4 py-2 rounded-xl bg-[var(--labu)] text-white font-medium hover:opacity-90">保存设置</button>
                                    <button id="disableDrawLimitBtn"
                                        class="px-4 py-2 rounded-xl bg-slate-100 border border-slate-200 hover:bg-slate-200">取消限制</button>
                                </div>
                                <div class="text-xs text-slate-500">
                                    当前限制：<span id="currentDrawLimit">未设置</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4 class="font-medium mb-3">用户抽奖统计</h4>
                            <div class="space-y-3">
                                <div class="p-3 rounded-lg bg-slate-50 text-sm">
                                    <div class="flex justify-between">
                                        <span>当前用户已抽奖：</span>
                                        <span class="font-medium" id="userDrawCount">0 次</span>
                                    </div>
                                </div>
                                <div class="p-3 rounded-lg bg-green-50 text-sm">
                                    <div class="flex justify-between">
                                        <span>🟢 实时同步状态：</span>
                                        <span class="font-medium text-green-600" id="syncStatus">已连接</span>
                                    </div>
                                    <div class="text-xs text-slate-500 mt-1">管理员修改将实时推送到所有用户</div>
                                </div>
                                <button id="resetUserDrawCountBtn"
                                    class="w-full px-4 py-2 rounded-xl bg-orange-100 text-orange-700 border border-orange-200 hover:bg-orange-200">重置用户抽奖次数</button>
                                <div class="text-xs text-slate-500">重置后用户可以重新开始抽奖</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 数据管理 -->
            <section class="mt-10">
                <div class="rounded-3xl bg-white border border-slate-200 shadow overflow-hidden">
                    <div class="p-5 border-b border-slate-100">
                        <h3 class="font-semibold">数据管理</h3>
                    </div>
                    <div class="p-5 grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-medium mb-3">抽奖记录管理</h4>
                            <div class="flex gap-3 flex-wrap">
                                <button id="exportHistoryBtn"
                                    class="px-4 py-2 rounded-xl bg-green-100 text-green-700 border border-green-200 hover:bg-green-200">导出抽奖记录</button>
                                <button id="clearHistoryBtn"
                                    class="px-4 py-2 rounded-xl bg-red-100 text-red-700 border border-red-200 hover:bg-red-200">清空抽奖记录</button>
                            </div>
                            <div class="mt-2 text-xs text-slate-500">当前记录数：<span id="historyCount">0</span></div>
                        </div>
                        <div>
                            <h4 class="font-medium mb-3">系统重置</h4>
                            <div class="flex gap-3 flex-wrap">
                                <button id="resetAllBtn"
                                    class="px-4 py-2 rounded-xl bg-red-100 text-red-700 border border-red-200 hover:bg-red-200">完全重置</button>
                            </div>
                            <div class="mt-2 text-xs text-slate-500">将清空所有数据并恢复默认奖池</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="max-w-5xl mx-auto px-4 py-10 text-center text-xs text-slate-500">
            <div>© <span id="year"></span> Labubu 抽奖管理系统</div>
        </footer>
    </div> <!-- 主界面内容结束 -->

    <script>
        // —— 配置常量 ——
        const ADMIN_PASSWORD = '123';
        const SESSION_KEY = 'labubu_admin_session';

        // —— 本地存储键 ——
        const LS_KEYS = {
            HISTORY: 'labubu_lottery_history',
            POOL: 'labubu_lottery_pool',
            DRAW_LIMIT: 'labubu_draw_limit',
            USER_DRAW_COUNT: 'labubu_user_draw_count'
        };

        // —— 数据同步广播 ——
        const dataChannel = new BroadcastChannel('labubu_data_sync');

        function broadcastUpdate(type, data = null) {
            const message = {
                type: type,
                data: data,
                timestamp: Date.now(),
                source: 'admin'
            };
            dataChannel.postMessage(message);
            console.log('📡 广播更新:', type);
            showBroadcastNotification(type);
        }

        function showBroadcastNotification(type) {
            const typeNames = {
                'POOL_UPDATE': '奖池配置',
                'DRAW_LIMIT_UPDATE': '抽奖限制',
                'USER_COUNT_RESET': '用户计数重置',
                'SYSTEM_RESET': '系统重置',
                'HISTORY_CLEARED': '记录清空'
            };

            const notification = document.createElement('div');
            notification.className = 'fixed top-20 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 text-sm transition-all duration-300';
            notification.innerHTML = `📡 ${typeNames[type] || type} 已推送到所有用户`;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 2000);
        }

        // —— 默认奖池（可编辑）——
        const DEFAULT_POOL = [
            { name: '¥20 抵扣券', type: '抵扣券', weight: 25, quantity: -1 },
            { name: '¥50 抵扣券', type: '抵扣券', weight: 15, quantity: -1 },
            { name: '9折优惠券', type: '折扣券', weight: 18, quantity: -1 },
            { name: '95折优惠券', type: '折扣券', weight: 22, quantity: -1 },
            { name: 'Labubu 限量手办（实体）', type: '实体', weight: 3, quantity: 5 },
            { name: 'Labubu 主题贴纸包（实体）', type: '实体', weight: 7, quantity: 50 },
            { name: '奶茶一杯（实体）', type: '实体', weight: 12, quantity: 30 },
            { name: '烤肉券（实体）', type: '实体', weight: 8, quantity: 20 },
            { name: '精品奶茶券（实体）', type: '实体', weight: 5, quantity: 15 },
            { name: '再接再厉', type: '折扣券', weight: 10, quantity: -1, note: '未中奖提示，可自定义' }
        ];

        // —— 工具函数 ——
        const $ = (sel) => document.querySelector(sel);

        function loadHistory() {
            try { return JSON.parse(localStorage.getItem(LS_KEYS.HISTORY)) || []; } catch { return []; }
        }
        function saveHistory(arr) { localStorage.setItem(LS_KEYS.HISTORY, JSON.stringify(arr)); }
        function loadPool() {
            try {
                const raw = localStorage.getItem(LS_KEYS.POOL);
                return raw ? JSON.parse(raw) : structuredClone(DEFAULT_POOL);
            } catch { return structuredClone(DEFAULT_POOL); }
        }
        function savePool(pool) { localStorage.setItem(LS_KEYS.POOL, JSON.stringify(pool)); }

        function poolToText(pool) {
            return pool.map(p => [p.name, p.type, p.weight, (p.quantity ?? -1)].join(',')).join('\n');
        }
        function textToPool(txt) {
            return txt.split(/\n+/).map(l => l.trim()).filter(Boolean).map((line, i) => {
                const [name, type, weightStr, qtyStr] = line.split(',').map(s => s?.trim());
                const weight = Number(weightStr);
                const quantity = (qtyStr === undefined || qtyStr === '') ? -1 : Number(qtyStr);
                if (!name || !['抵扣券', '实体', '折扣券'].includes(type) || !Number.isFinite(weight)) {
                    throw new Error(`第 ${i + 1} 行格式不正确：${line}`);
                }
                return { name, type, weight, quantity };
            });
        }

        function renderPoolList(pool) {
            const ul = $('#poolList');
            ul.innerHTML = '';
            const totalW = pool.reduce((s, p) => s + Math.max(0, p.weight || 0), 0) || 1;

            pool.forEach(p => {
                const left = p.quantity === -1 ? '∞' : p.quantity;
                const w = p.weight || 0;
                const pct = ((w / totalW) * 100).toFixed(1);
                const color = p.type === '实体' ? 'bg-emerald-50 text-emerald-700 border-emerald-200' :
                    (p.type === '抵扣券' ? 'bg-indigo-50 text-indigo-700 border-indigo-200' : 'bg-amber-50 text-amber-700 border-amber-200');

                const li = document.createElement('li');
                li.className = `border rounded-xl p-3 ${color}`;
                li.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="font-medium">${p.name}</div>
                        <span class="text-xs px-2 py-0.5 rounded-lg bg-white/60 border">${p.type}</span>
                    </div>
                    <div class="text-xs mt-1 flex justify-between">
                        <span>权重: ${w} (≈${pct}%)</span>
                        <span>剩余: <b>${left}</b></span>
                    </div>
                `;
                ul.appendChild(li);
            });

            // 更新统计信息
            const stats = $('#poolStats');
            const totalItems = pool.length;
            const totalWeight = totalW;
            const physicalItems = pool.filter(p => p.type === '实体').length;
            stats.innerHTML = `总计 ${totalItems} 种奖品 | 总权重: ${totalWeight} | 实体奖品: ${physicalItems} 种`;
        }

        function refreshPoolEditor() {
            const pool = loadPool();
            $('#poolEditor').value = poolToText(pool);
        }

        function exportHistory() {
            const history = loadHistory();
            const data = JSON.stringify(history, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `labubu_lottery_history_${Date.now()}.json`;
            a.click();
        }

        function clearHistory() {
            if (confirm('确认清空所有抽奖记录？此操作不可恢复！')) {
                saveHistory([]);
                updateHistoryCount();
                broadcastUpdate('HISTORY_CLEARED'); // 广播记录清空（如果需要的话）
                alert('抽奖记录已清空');
            }
        }

        function resetAll() {
            if (confirm('确认完全重置系统？这将清空所有数据并恢复默认奖池！')) {
                localStorage.removeItem(LS_KEYS.HISTORY);
                localStorage.removeItem(LS_KEYS.POOL);
                localStorage.removeItem(LS_KEYS.DRAW_LIMIT);
                localStorage.removeItem(LS_KEYS.USER_DRAW_COUNT);
                refreshPoolEditor();
                renderPoolList(loadPool());
                updateHistoryCount();
                updateDrawLimitDisplay();
                broadcastUpdate('SYSTEM_RESET'); // 广播系统重置
                alert('系统已重置到默认状态，所有用户界面将自动刷新');
            }
        }

        function updateHistoryCount() {
            const count = loadHistory().length;
            $('#historyCount').textContent = count;
        }

        // —— 抽奖次数限制管理 ——
        function loadDrawLimit() {
            try {
                const limit = localStorage.getItem(LS_KEYS.DRAW_LIMIT);
                return limit ? parseInt(limit) : 0; // 0表示不限制
            } catch { return 0; }
        }

        function saveDrawLimit(limit) {
            localStorage.setItem(LS_KEYS.DRAW_LIMIT, limit.toString());
        }

        function loadUserDrawCount() {
            try {
                const count = localStorage.getItem(LS_KEYS.USER_DRAW_COUNT);
                return count ? parseInt(count) : 0;
            } catch { return 0; }
        }

        function saveUserDrawCount(count) {
            localStorage.setItem(LS_KEYS.USER_DRAW_COUNT, count.toString());
        }

        function updateDrawLimitDisplay() {
            const limit = loadDrawLimit();
            const currentLimitSpan = $('#currentDrawLimit');
            const drawLimitInput = $('#drawLimitInput');

            if (limit === 0) {
                currentLimitSpan.textContent = '不限制';
                drawLimitInput.value = '';
            } else {
                currentLimitSpan.textContent = `${limit} 次`;
                drawLimitInput.value = limit;
            }

            const userCount = loadUserDrawCount();
            $('#userDrawCount').textContent = `${userCount} 次`;
        }

        function setDrawLimit() {
            const input = $('#drawLimitInput');
            const limit = parseInt(input.value) || 0;

            if (limit < 0) {
                alert('抽奖次数不能为负数');
                return;
            }

            if (limit > 9999) {
                alert('抽奖次数不能超过9999次');
                return;
            }

            saveDrawLimit(limit);
            updateDrawLimitDisplay();
            broadcastUpdate('DRAW_LIMIT_UPDATE', { limit }); // 广播限制更新

            if (limit === 0) {
                alert('抽奖次数限制已取消并同步到所有用户');
            } else {
                alert(`抽奖次数限制已设置为 ${limit} 次并同步到所有用户`);
            }
        }

        function disableDrawLimit() {
            if (confirm('确认取消抽奖次数限制？用户将可以无限制抽奖。')) {
                saveDrawLimit(0);
                updateDrawLimitDisplay();
                broadcastUpdate('DRAW_LIMIT_UPDATE', { limit: 0 }); // 广播限制取消
                alert('抽奖次数限制已取消并同步到所有用户');
            }
        }

        function resetUserDrawCount() {
            if (confirm('确认重置用户抽奖次数？重置后用户可以重新开始抽奖。')) {
                saveUserDrawCount(0);
                updateDrawLimitDisplay();
                broadcastUpdate('USER_COUNT_RESET'); // 广播用户计数重置
                alert('用户抽奖次数已重置并同步到所有用户');
            }
        }

        // —— 登录验证相关 ——
        function isLoggedIn() {
            return sessionStorage.getItem(SESSION_KEY) === 'authenticated';
        }

        function login(password) {
            if (password === ADMIN_PASSWORD) {
                sessionStorage.setItem(SESSION_KEY, 'authenticated');
                showMainContent();
                return true;
            }
            return false;
        }

        function logout() {
            sessionStorage.removeItem(SESSION_KEY);
            showLoginOverlay();
        }

        function showLoginOverlay() {
            $('#loginOverlay').classList.remove('hidden');
            $('#mainContent').classList.add('hidden');
            $('#adminPassword').value = '';
            $('#loginError').classList.add('hidden');
            $('#adminPassword').focus();
        }

        function showMainContent() {
            $('#loginOverlay').classList.add('hidden');
            $('#mainContent').classList.remove('hidden');
        }

        function handleLogin() {
            const password = $('#adminPassword').value;
            const errorDiv = $('#loginError');

            if (!password) {
                errorDiv.textContent = '请输入密码';
                errorDiv.classList.remove('hidden');
                return;
            }

            if (login(password)) {
                errorDiv.classList.add('hidden');
            } else {
                errorDiv.textContent = '密码错误，请重试';
                errorDiv.classList.remove('hidden');
                $('#adminPassword').value = '';
                $('#adminPassword').focus();
            }
        }

        // —— 事件绑定 ——
        function bind() {
            // 登录相关事件
            $('#loginBtn').addEventListener('click', handleLogin);
            $('#logoutBtn').addEventListener('click', () => {
                if (confirm('确认退出管理系统？')) {
                    logout();
                }
            });
            $('#adminPassword').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });

            // 原有功能事件
            $('#savePoolBtn').addEventListener('click', () => {
                try {
                    const text = $('#poolEditor').value;
                    const pool = textToPool(text);
                    savePool(pool);
                    renderPoolList(pool);
                    broadcastUpdate('POOL_UPDATE', pool); // 广播奖池更新
                    alert('奖池配置已保存并同步到所有用户');
                } catch (e) {
                    alert('保存失败：' + e.message);
                }
            });

            $('#reloadBtn').addEventListener('click', () => {
                refreshPoolEditor();
                renderPoolList(loadPool());
                alert('已重新载入当前配置');
            });

            $('#restoreDefaultBtn').addEventListener('click', () => {
                if (confirm('确认恢复默认奖池配置？当前配置将被覆盖！')) {
                    const defaultPool = structuredClone(DEFAULT_POOL);
                    savePool(defaultPool);
                    refreshPoolEditor();
                    renderPoolList(loadPool());
                    broadcastUpdate('POOL_UPDATE', defaultPool); // 广播奖池更新
                    alert('已恢复默认奖池配置并同步到所有用户');
                }
            });

            $('#refreshPreviewBtn').addEventListener('click', () => {
                renderPoolList(loadPool());
            });

            $('#exportHistoryBtn').addEventListener('click', exportHistory);
            $('#clearHistoryBtn').addEventListener('click', clearHistory);
            $('#resetAllBtn').addEventListener('click', resetAll);

            // 抽奖次数限制相关事件
            $('#saveDrawLimitBtn').addEventListener('click', setDrawLimit);
            $('#disableDrawLimitBtn').addEventListener('click', disableDrawLimit);
            $('#resetUserDrawCountBtn').addEventListener('click', resetUserDrawCount);
            $('#drawLimitInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    setDrawLimit();
                }
            });
        }

        function init() {
            $('#year').textContent = new Date().getFullYear();

            // 检查登录状态
            if (isLoggedIn()) {
                showMainContent();
                // 初始化主界面内容
                refreshPoolEditor();
                renderPoolList(loadPool());
                updateHistoryCount();
                updateDrawLimitDisplay();
            } else {
                showLoginOverlay();
            }
        }

        bind();
        init();
    </script>
</body>

</html>