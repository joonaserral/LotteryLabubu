<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»»åŠ¡ä¸­å¿ƒ - Labubu å¹¸è¿æŠ½å¥– ğŸ§¸</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ§¸</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --labu: #6b5b95;
            --labu2: #ffcc00;
        }

        .labu-gradient {
            background-image: linear-gradient(135deg, rgba(107, 91, 149, .15), rgba(255, 204, 0, .15));
        }

        .sparkle {
            animation: sparkle 2s ease-in-out infinite alternate;
        }

        @keyframes sparkle {
            0% {
                transform: scale(1) rotate(0deg);
            }

            100% {
                transform: scale(1.1) rotate(5deg);
            }
        }

        /* è‡ªå®šä¹‰é¼ æ ‡æ ·å¼ */
        * {
            cursor: none !important;
        }

        .custom-cursor {
            position: fixed;
            width: 20px;
            height: 20px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff69b4"><path d="M8 2C8 2 8.5 3 10.5 3C12.5 3 13 2 13 2C14 2 15 3 15 4C15 5 14 6 13 6C12 6 11 7 11 8C11 9 12 10 13 10C14 10 15 9 15 8C15 7 16 6 17 6C18 6 19 7 19 8C19 9 18 10 17 10C16 10 15 11 15 12C15 13 16 14 17 14C18 14 19 13 19 12C19 11 20 10 21 10C22 10 23 11 23 12C23 13 22 14 21 14C20 14 19 15 19 16C19 17 18 18 17 18C16 18 15 17 15 16C15 15 14 14 13 14C12 14 11 15 11 16C11 17 10 18 9 18C8 18 7 17 7 16C7 15 8 14 9 14C10 14 11 13 11 12C11 11 10 10 9 10C8 10 7 11 7 12C7 13 6 14 5 14C4 14 3 13 3 12C3 11 4 10 5 10C6 10 7 9 7 8C7 7 6 6 5 6C4 6 3 7 3 8C3 9 2 10 1 10C0 10 -1 9 -1 8C-1 7 0 6 1 6C2 6 3 5 3 4C3 3 4 2 5 2C6 2 7 3 7 4C7 5 8 6 9 6C10 6 11 5 11 4C11 3 10 2 9 2C8.5 2 8 2 8 2Z"/></svg>') no-repeat center;
            background-size: contain;
            pointer-events: none;
            z-index: 9999;
            transition: transform 0.1s ease;
            transform: translate(-50%, -50%);
        }

        .custom-cursor.clicking {
            transform: translate(-50%, -50%) scale(1.2);
        }

        .cursor-trail {
            position: fixed;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(255, 105, 180, 0.8) 0%, rgba(255, 105, 180, 0) 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9998;
            animation: cursorTrailFade 0.5s ease-out forwards;
        }

        @keyframes cursorTrailFade {
            0% {
                opacity: 1;
                transform: scale(1);
            }

            100% {
                opacity: 0;
                transform: scale(0.3);
            }
        }

        /* ä»»åŠ¡å¡ç‰‡åŠ¨ç”» */
        .task-card {
            transition: all 0.3s ease;
        }

        .task-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
        }

        .task-completed {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05));
            border-color: #22c55e;
        }

        .task-progress {
            background: linear-gradient(90deg, var(--labu) 0%, var(--labu2) 100%);
            transition: width 0.5s ease;
        }

        /* å¥–åŠ±åŠ¨ç”» */
        .reward-bounce {
            animation: rewardBounce 0.6s ease-out;
        }

        @keyframes rewardBounce {
            0% {
                transform: scale(0.8);
                opacity: 0;
            }

            50% {
                transform: scale(1.1);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* ç­¾åˆ°æ‰“å¡åŠ¨ç”» */
        .checkin-effect {
            animation: checkinPulse 1s ease-out;
        }

        @keyframes checkinPulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
                box-shadow: 0 0 20px rgba(107, 91, 149, 0.5);
            }

            100% {
                transform: scale(1);
            }
        }

        /* æ¯æ—¥æŒ‘æˆ˜è¿›åº¦ç¯ */
        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            transition: stroke-dashoffset 0.5s ease-in-out;
        }

        /* æŒ‰é’®å¢å¼ºæ•ˆæœ */
        .enhanced-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .enhanced-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .enhanced-btn:hover::before {
            left: 100%;
        }

        .enhanced-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(107, 91, 149, 0.3);
        }

        /* å‹‹ç« å±•ç¤º */
        .badge-glow {
            animation: badgeGlow 2s ease-in-out infinite alternate;
        }

        @keyframes badgeGlow {
            0% {
                box-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
            }

            100% {
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            }
        }

        /* ç‰¹æ•ˆç²’å­ */
        .magic-particle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, #ffd700 0%, #ff69b4 50%, transparent 100%);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9997;
            animation: magicParticle 2s ease-out forwards;
        }

        @keyframes magicParticle {
            0% {
                opacity: 1;
                transform: scale(0) rotate(0deg);
            }

            50% {
                opacity: 1;
                transform: scale(1) rotate(180deg);
            }

            100% {
                opacity: 0;
                transform: scale(0.2) rotate(360deg) translateY(-50px);
            }
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900">
    <!-- è‡ªå®šä¹‰é¼ æ ‡å…‰æ ‡ -->
    <div class="custom-cursor"></div>

    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="sticky top-0 z-30 backdrop-blur bg-white/90 border-b border-slate-200 shadow-sm">
        <div class="max-w-6xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-xl bg-[var(--labu)] grid place-content-center text-white text-xl sparkle">
                        ğŸ“‹</div>
                    <div>
                        <h1 class="font-bold text-lg">ä»»åŠ¡ä¸­å¿ƒ</h1>
                        <p class="text-xs text-slate-500">å®Œæˆä»»åŠ¡ï¼Œèµ¢å–å¥–åŠ± âœ¨</p>
                    </div>
                </div>
                <nav class="flex items-center gap-6">
                    <a href="index.html" class="text-slate-600 hover:text-[var(--labu)] transition-colors">ğŸ¯ æŠ½å¥–</a>
                    <a href="shop.html" class="text-slate-600 hover:text-[var(--labu)] transition-colors">ğŸ›’ å•†åŸ</a>
                    <a href="user-center.html" class="text-slate-600 hover:text-[var(--labu)] transition-colors">ğŸ‘¤
                        ä¸ªäººä¸­å¿ƒ</a>
                </nav>
            </div>
        </div>
    </header>

    <div class="max-w-6xl mx-auto px-4 py-8">
        <!-- é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ -->
        <div class="grid md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-2xl p-6 text-center shadow-sm">
                <div class="text-3xl mb-2">ğŸ¯</div>
                <div class="text-2xl font-bold text-[var(--labu)]" id="todayCompleted">5</div>
                <div class="text-sm text-slate-600">ä»Šæ—¥å®Œæˆ</div>
            </div>

            <div class="bg-white rounded-2xl p-6 text-center shadow-sm">
                <div class="text-3xl mb-2">ğŸ”¥</div>
                <div class="text-2xl font-bold text-orange-500" id="streakDays">7</div>
                <div class="text-sm text-slate-600">è¿ç»­å¤©æ•°</div>
            </div>

            <div class="bg-white rounded-2xl p-6 text-center shadow-sm">
                <div class="text-3xl mb-2">ğŸ’°</div>
                <div class="text-2xl font-bold text-yellow-500" id="totalCoins">2,350</div>
                <div class="text-sm text-slate-600">æ€»ç§¯åˆ†</div>
            </div>

            <div class="bg-white rounded-2xl p-6 text-center shadow-sm">
                <div class="text-3xl mb-2">ğŸ…</div>
                <div class="text-2xl font-bold text-purple-500" id="totalBadges">12</div>
                <div class="text-sm text-slate-600">è·å¾—å¾½ç« </div>
            </div>
        </div>

        <div class="grid lg:grid-cols-3 gap-8">
            <!-- å·¦ä¾§ - æ¯æ—¥ç­¾åˆ° -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-3xl p-6 shadow-sm mb-6">
                    <h3 class="font-semibold mb-4 flex items-center gap-2">
                        ğŸ“… æ¯æ—¥ç­¾åˆ°
                    </h3>

                    <!-- ç­¾åˆ°ä¸»åŒºåŸŸ -->
                    <div class="text-center mb-6">
                        <div class="relative inline-block">
                            <svg class="progress-ring w-32 h-32" viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="45" stroke="#e2e8f0" stroke-width="8" fill="none" />
                                <circle id="progressCircle" class="progress-ring-circle" cx="50" cy="50" r="45"
                                    stroke="var(--labu)" stroke-width="8" fill="none" />
                            </svg>
                            <div class="absolute inset-0 flex flex-col items-center justify-center">
                                <div class="text-4xl mb-1" id="checkinIcon">ğŸ“…</div>
                                <div class="text-sm font-medium" id="checkinStatus">ä»Šæ—¥æœªç­¾åˆ°</div>
                            </div>
                        </div>

                        <button id="checkinBtn"
                            class="enhanced-btn mt-4 px-6 py-3 bg-[var(--labu)] text-white rounded-xl font-medium">
                            ç«‹å³ç­¾åˆ° âœ¨
                        </button>
                    </div>

                    <!-- ç­¾åˆ°å¥–åŠ±é¢„è§ˆ -->
                    <div class="space-y-2">
                        <div class="text-sm font-medium text-slate-700 mb-2">ç­¾åˆ°å¥–åŠ±</div>
                        <div class="flex justify-between items-center p-2 bg-slate-50 rounded-lg">
                            <span class="text-sm">ç¬¬1å¤©</span>
                            <span class="text-sm">ğŸª™ 10ç§¯åˆ†</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-slate-50 rounded-lg">
                            <span class="text-sm">ç¬¬3å¤©</span>
                            <span class="text-sm">ğŸ ç¥ç§˜ç›²ç›’</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-slate-50 rounded-lg">
                            <span class="text-sm">ç¬¬7å¤©</span>
                            <span class="text-sm">ğŸ¯ æŠ½å¥–æ¬¡æ•°+3</span>
                        </div>
                        <div class="flex justify-between items-center p-2 bg-slate-50 rounded-lg">
                            <span class="text-sm">ç¬¬15å¤©</span>
                            <span class="text-sm">ğŸ’ ç¨€æœ‰Labubu</span>
                        </div>
                    </div>
                </div>

                <!-- å‹‹ç« å±•ç¤º -->
                <div class="bg-white rounded-3xl p-6 shadow-sm">
                    <h3 class="font-semibold mb-4 flex items-center gap-2">
                        ğŸ† æœ¬å‘¨å‹‹ç« 
                    </h3>

                    <div class="grid grid-cols-2 gap-3">
                        <div class="badge-glow bg-yellow-100 rounded-xl p-3 text-center border-2 border-yellow-300">
                            <div class="text-2xl mb-1">ğŸ¥‡</div>
                            <div class="text-xs font-medium">ç­¾åˆ°è¾¾äºº</div>
                        </div>
                        <div class="bg-slate-100 rounded-xl p-3 text-center border-2 border-slate-300">
                            <div class="text-2xl mb-1">ğŸ¥ˆ</div>
                            <div class="text-xs font-medium">ä»»åŠ¡æ–°æ‰‹</div>
                        </div>
                        <div class="bg-slate-100 rounded-xl p-3 text-center border-2 border-slate-300">
                            <div class="text-2xl mb-1">ğŸ¥‰</div>
                            <div class="text-xs font-medium">è¯„è®ºå®¶</div>
                        </div>
                        <div class="bg-slate-100 rounded-xl p-3 text-center border-2 border-slate-300">
                            <div class="text-2xl mb-1">ğŸŒŸ</div>
                            <div class="text-xs font-medium">åˆ†äº«è¾¾äºº</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ - ä»»åŠ¡åˆ—è¡¨ -->
            <div class="lg:col-span-2">
                <!-- æ¯æ—¥ä»»åŠ¡ -->
                <div class="bg-white rounded-3xl p-6 shadow-sm mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-semibold flex items-center gap-2">
                            ğŸŒ… æ¯æ—¥ä»»åŠ¡
                        </h3>
                        <span class="text-sm text-slate-500" id="dailyProgress">3/5 å·²å®Œæˆ</span>
                    </div>

                    <div class="space-y-4" id="dailyTasks">
                        <!-- æ¯æ—¥ä»»åŠ¡å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æ¯å‘¨ä»»åŠ¡ -->
                <div class="bg-white rounded-3xl p-6 shadow-sm mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-semibold flex items-center gap-2">
                            ğŸ“Š æ¯å‘¨ä»»åŠ¡
                        </h3>
                        <span class="text-sm text-slate-500" id="weeklyProgress">2/3 å·²å®Œæˆ</span>
                    </div>

                    <div class="space-y-4" id="weeklyTasks">
                        <!-- æ¯å‘¨ä»»åŠ¡å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>

                <!-- æˆå°±ä»»åŠ¡ -->
                <div class="bg-white rounded-3xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-semibold flex items-center gap-2">
                            ğŸ† æˆå°±ä»»åŠ¡
                        </h3>
                        <span class="text-sm text-slate-500" id="achievementProgress">5/8 å·²å®Œæˆ</span>
                    </div>

                    <div class="space-y-4" id="achievementTasks">
                        <!-- æˆå°±ä»»åŠ¡å°†é€šè¿‡JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä»»åŠ¡å®Œæˆå¼¹çª— -->
    <div id="taskCompleteModal"
        class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl p-8 mx-4 max-w-md w-full text-center">
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h3 class="text-xl font-bold mb-2">ä»»åŠ¡å®Œæˆï¼</h3>
            <p class="text-slate-600 mb-4" id="rewardText">æ­å–œè·å¾—å¥–åŠ±</p>
            <div class="flex justify-center gap-3">
                <button id="claimReward"
                    class="enhanced-btn px-6 py-2 bg-[var(--labu)] text-white rounded-xl font-medium">
                    é¢†å–å¥–åŠ±
                </button>
                <button id="closeModal" class="enhanced-btn px-6 py-2 bg-slate-100 rounded-xl font-medium">
                    å…³é—­
                </button>
            </div>
        </div>
    </div>

    <script>
        // å·¥å…·å‡½æ•°
        const $ = (selector) => document.querySelector(selector);
        const $$ = (selector) => document.querySelectorAll(selector);

        // ä»»åŠ¡æ•°æ®
        const dailyTasks = [
            { id: 1, name: 'å®Œæˆä¸€æ¬¡æŠ½å¥–', icon: 'ğŸ¯', progress: 1, target: 1, reward: '20ç§¯åˆ†', completed: true },
            { id: 2, name: 'è®¿é—®å•†åŸé¡µé¢', icon: 'ğŸ›’', progress: 1, target: 1, reward: '10ç§¯åˆ†', completed: true },
            { id: 3, name: 'å‘è¡¨ä¸€æ¡ç•™è¨€', icon: 'ğŸ’¬', progress: 1, target: 1, reward: '15ç§¯åˆ†', completed: true },
            { id: 4, name: 'åˆ†äº«ç»™æœ‹å‹', icon: 'ğŸ“¤', progress: 0, target: 1, reward: '25ç§¯åˆ†', completed: false },
            { id: 5, name: 'æŠ½å¥–3æ¬¡', icon: 'ğŸ²', progress: 2, target: 3, reward: '30ç§¯åˆ†', completed: false }
        ];

        const weeklyTasks = [
            { id: 6, name: 'ç´¯è®¡æŠ½å¥–20æ¬¡', icon: 'ğŸ¯', progress: 18, target: 20, reward: '100ç§¯åˆ†', completed: false },
            { id: 7, name: 'è·å¾—5ä¸ªä¸åŒå¥–å“', icon: 'ğŸ', progress: 5, target: 5, reward: '150ç§¯åˆ†', completed: true },
            { id: 8, name: 'è¿ç»­ç­¾åˆ°7å¤©', icon: 'ğŸ“…', progress: 7, target: 7, reward: '200ç§¯åˆ† + æŠ½å¥–æ¬¡æ•°', completed: true }
        ];

        const achievementTasks = [
            { id: 9, name: 'æ”¶é›†10ç§Labubu', icon: 'ğŸ§¸', progress: 8, target: 10, reward: 'ç‰¹æ®Šå¾½ç« ', completed: false },
            { id: 10, name: 'æ€»æŠ½å¥–æ¬¡æ•°è¾¾100', icon: 'ğŸ’¯', progress: 100, target: 100, reward: 'ä¼ è¯´Labubu', completed: true },
            { id: 11, name: 'è·å¾—ä¼ è¯´çº§å¥–å“', icon: 'ğŸŒŸ', progress: 1, target: 1, reward: 'ä¸“å±å¤´åƒ', completed: true },
            { id: 12, name: 'ç•™è¨€è·å¾—100ä¸ªèµ', icon: 'ğŸ‘', progress: 87, target: 100, reward: 'ç¤¾äº¤è¾¾äººå‹‹ç« ', completed: false },
            { id: 13, name: 'è¿ç»­ç­¾åˆ°30å¤©', icon: 'ğŸ”¥', progress: 23, target: 30, reward: 'æœˆåº¦å¥–åŠ±åŒ…', completed: false },
            { id: 14, name: 'å•†åŸæ¶ˆè´¹æ»¡500å…ƒ', icon: 'ğŸ’°', progress: 350, target: 500, reward: 'VIPä¼šå‘˜', completed: false },
            { id: 15, name: 'é‚€è¯·10ä½å¥½å‹', icon: 'ğŸ‘¥', progress: 6, target: 10, reward: 'é‚€è¯·å¤§ä½¿ç§°å·', completed: false },
            { id: 16, name: 'å®Œæˆæ‰€æœ‰æ¯æ—¥ä»»åŠ¡30å¤©', icon: 'ğŸ“‹', progress: 30, target: 30, reward: 'å®Œç¾ä¸»ä¹‰è€…', completed: true }
        ];

        let userData = {
            todayCompleted: 5,
            streakDays: 7,
            totalCoins: 2350,
            totalBadges: 12,
            checkedInToday: false
        };

        // åˆå§‹åŒ–
        function init() {
            renderStatistics();
            renderTasks();
            updateSigninStatus();
            initEventListeners();
            initCustomCursor();
        }

        // æ¸²æŸ“ç»Ÿè®¡æ•°æ®
        function renderStatistics() {
            $('#todayCompleted').textContent = userData.todayCompleted;
            $('#streakDays').textContent = userData.streakDays;
            $('#totalCoins').textContent = userData.totalCoins.toLocaleString();
            $('#totalBadges').textContent = userData.totalBadges;
        }

        // æ¸²æŸ“ä»»åŠ¡åˆ—è¡¨
        function renderTasks() {
            renderTaskGroup(dailyTasks, '#dailyTasks', '#dailyProgress');
            renderTaskGroup(weeklyTasks, '#weeklyTasks', '#weeklyProgress');
            renderTaskGroup(achievementTasks, '#achievementTasks', '#achievementProgress');
        }

        // æ¸²æŸ“ä»»åŠ¡ç»„
        function renderTaskGroup(tasks, containerId, progressId) {
            const container = $(containerId);
            const completedCount = tasks.filter(t => t.completed).length;

            $(progressId).textContent = `${completedCount}/${tasks.length} å·²å®Œæˆ`;

            container.innerHTML = tasks.map(task => createTaskCard(task)).join('');
        }

        // åˆ›å»ºä»»åŠ¡å¡ç‰‡
        function createTaskCard(task) {
            const progressPercent = (task.progress / task.target) * 100;
            const canClaim = task.progress >= task.target && !task.completed;

            return `
                <div class="task-card ${task.completed ? 'task-completed' : ''} border border-slate-200 rounded-2xl p-4">
                    <div class="flex items-center gap-4">
                        <div class="text-3xl">${task.icon}</div>
                        <div class="flex-1">
                            <div class="flex items-center justify-between mb-2">
                                <h4 class="font-medium">${task.name}</h4>
                                <div class="text-sm text-slate-500">
                                    ${task.progress}/${task.target}
                                </div>
                            </div>
                            
                            <!-- è¿›åº¦æ¡ -->
                            <div class="w-full bg-slate-200 rounded-full h-2 mb-2">
                                <div class="task-progress h-2 rounded-full" style="width: ${Math.min(progressPercent, 100)}%"></div>
                            </div>
                            
                            <div class="flex items-center justify-between">
                                <span class="text-sm text-slate-600">å¥–åŠ±: ${task.reward}</span>
                                <button class="enhanced-btn px-4 py-2 rounded-lg text-sm font-medium
                                              ${task.completed ? 'bg-gray-100 text-gray-500' :
                    canClaim ? 'bg-[var(--labu)] text-white' : 'bg-slate-100 text-slate-600'}"
                                        onclick="handleTaskAction(${task.id})"
                                        ${task.completed ? 'disabled' : ''}>
                                    ${task.completed ? 'âœ… å·²å®Œæˆ' : canClaim ? 'ğŸ é¢†å–å¥–åŠ±' : 'ğŸ“‹ å»å®Œæˆ'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // å¤„ç†ä»»åŠ¡æ“ä½œ
        function handleTaskAction(taskId) {
            const allTasks = [...dailyTasks, ...weeklyTasks, ...achievementTasks];
            const task = allTasks.find(t => t.id === taskId);

            if (!task) return;

            if (task.progress >= task.target && !task.completed) {
                // é¢†å–å¥–åŠ±
                claimTaskReward(task);
            } else {
                // è·³è½¬åˆ°ç›¸åº”é¡µé¢å®Œæˆä»»åŠ¡
                redirectToTask(task);
            }
        }

        // é¢†å–ä»»åŠ¡å¥–åŠ±
        function claimTaskReward(task) {
            task.completed = true;

            // æ˜¾ç¤ºå¥–åŠ±å¼¹çª—
            $('#rewardText').textContent = `æ­å–œå®Œæˆä»»åŠ¡"${task.name}"ï¼Œè·å¾—${task.reward}ï¼`;
            $('#taskCompleteModal').classList.remove('hidden');

            // æ›´æ–°ç”¨æˆ·æ•°æ®
            userData.todayCompleted++;
            userData.totalCoins += parseInt(task.reward.match(/\d+/)?.[0] || 0);

            renderStatistics();
            renderTasks();

            // åˆ›å»ºåº†ç¥æ•ˆæœ
            createCelebrationEffect();
        }

        // è·³è½¬åˆ°ä»»åŠ¡
        function redirectToTask(task) {
            if (task.name.includes('æŠ½å¥–')) {
                window.location.href = 'index.html#draw';
            } else if (task.name.includes('å•†åŸ')) {
                window.location.href = 'shop.html';
            } else if (task.name.includes('ç•™è¨€')) {
                window.location.href = 'index.html#comments';
            } else if (task.name.includes('åˆ†äº«')) {
                showShareDialog();
            }
        }

        // æ˜¾ç¤ºåˆ†äº«å¯¹è¯æ¡†
        function showShareDialog() {
            const shareText = "æˆ‘åœ¨LabubuæŠ½å¥–ç³»ç»Ÿè·å¾—äº†è¶…æ£’çš„å¥–å“ï¼å¿«æ¥ä¸€èµ·ç©å§ï¼";

            if (navigator.share) {
                navigator.share({
                    title: 'Labubu æŠ½å¥–ç³»ç»Ÿ',
                    text: shareText,
                    url: window.location.origin
                });
            } else {
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                navigator.clipboard.writeText(shareText + ' ' + window.location.origin).then(() => {
                    showNotification('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                });
            }
        }

        // æ›´æ–°ç­¾åˆ°çŠ¶æ€
        function updateSigninStatus() {
            const progressCircle = $('#progressCircle');
            const checkinIcon = $('#checkinIcon');
            const checkinStatus = $('#checkinStatus');
            const checkinBtn = $('#checkinBtn');

            if (userData.checkedInToday) {
                // å·²ç­¾åˆ°çŠ¶æ€
                progressCircle.style.strokeDashoffset = '0';
                checkinIcon.textContent = 'âœ…';
                checkinStatus.textContent = 'ä»Šæ—¥å·²ç­¾åˆ°';
                checkinBtn.textContent = 'æ˜æ—¥å†æ¥';
                checkinBtn.disabled = true;
                checkinBtn.classList.add('opacity-50');
            } else {
                // æœªç­¾åˆ°çŠ¶æ€
                progressCircle.style.strokeDashoffset = '283';
                checkinIcon.textContent = 'ğŸ“…';
                checkinStatus.textContent = 'ä»Šæ—¥æœªç­¾åˆ°';
                checkinBtn.textContent = 'ç«‹å³ç­¾åˆ° âœ¨';
                checkinBtn.disabled = false;
                checkinBtn.classList.remove('opacity-50');
            }
        }

        // æ‰§è¡Œç­¾åˆ°
        function performCheckin() {
            if (userData.checkedInToday) return;

            userData.checkedInToday = true;
            userData.streakDays++;
            userData.totalCoins += 20;

            // æ›´æ–°UI
            updateSigninStatus();
            renderStatistics();

            // æ·»åŠ ç­¾åˆ°æ•ˆæœ
            const checkinBtn = $('#checkinBtn');
            checkinBtn.classList.add('checkin-effect');

            setTimeout(() => {
                checkinBtn.classList.remove('checkin-effect');
            }, 1000);

            // æ˜¾ç¤ºç­¾åˆ°å¥–åŠ±
            showNotification('âœ… ç­¾åˆ°æˆåŠŸï¼è·å¾— 20 ç§¯åˆ†');

            // åˆ›å»ºç²’å­æ•ˆæœ
            createCelebrationEffect();
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-xl z-50 transform translate-x-full transition-transform duration-300';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);

            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // åˆ›å»ºåº†ç¥æ•ˆæœ
        function createCelebrationEffect() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'magic-particle';
                    particle.style.left = (window.innerWidth / 2 + Math.random() * 200 - 100) + 'px';
                    particle.style.top = (window.innerHeight / 2 + Math.random() * 200 - 100) + 'px';
                    document.body.appendChild(particle);

                    setTimeout(() => {
                        if (document.body.contains(particle)) {
                            document.body.removeChild(particle);
                        }
                    }, 2000);
                }, i * 100);
            }
        }

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
        function initEventListeners() {
            // ç­¾åˆ°æŒ‰é’®
            $('#checkinBtn').addEventListener('click', performCheckin);

            // å¥–åŠ±å¼¹çª—
            $('#claimReward').addEventListener('click', () => {
                $('#taskCompleteModal').classList.add('hidden');
            });

            $('#closeModal').addEventListener('click', () => {
                $('#taskCompleteModal').classList.add('hidden');
            });

            // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
            $('#taskCompleteModal').addEventListener('click', (e) => {
                if (e.target === $('#taskCompleteModal')) {
                    $('#taskCompleteModal').classList.add('hidden');
                }
            });
        }

        // è‡ªå®šä¹‰é¼ æ ‡æ•ˆæœ
        function initCustomCursor() {
            const cursor = $('.custom-cursor');
            let mouseX = 0, mouseY = 0;

            document.addEventListener('mousemove', (e) => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                cursor.style.left = mouseX + 'px';
                cursor.style.top = mouseY + 'px';

                createCursorTrail(mouseX, mouseY);
            });

            document.addEventListener('mousedown', () => {
                cursor.classList.add('clicking');
            });

            document.addEventListener('mouseup', () => {
                cursor.classList.remove('clicking');
            });
        }

        function createCursorTrail(x, y) {
            const trail = document.createElement('div');
            trail.className = 'cursor-trail';
            trail.style.left = (x - 4) + 'px';
            trail.style.top = (y - 4) + 'px';
            document.body.appendChild(trail);

            setTimeout(() => {
                if (document.body.contains(trail)) {
                    document.body.removeChild(trail);
                }
            }, 500);
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>